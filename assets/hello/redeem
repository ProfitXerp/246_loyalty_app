import 'package:flutter/material.dart';

void main() {
  runApp(const RedeemApp());
}

class RedeemApp extends StatelessWidget {
  const RedeemApp({super.key});

  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      title: 'Redeem Rewards',
      theme: ThemeData(
        colorScheme: ColorScheme.fromSeed(seedColor: Colors.deepPurple),
        useMaterial3: true,
      ),
      home: const RedeemPage(),
      debugShowCheckedModeBanner: false,
    );
  }
}

class RedeemPage extends StatefulWidget {
  const RedeemPage({super.key});

  @override
  State<RedeemPage> createState() => _RedeemPageState();
}

class _RedeemPageState extends State<RedeemPage> {
  final int definedPoints = 3000;
  List<Map<String, dynamic>> matchedRewards = [];

  final List<Map<String, dynamic>> allRewardsData = [
    {
      "points": 2000,
      "rewards": [
        {
          "name": "Gear Cycle",
          "image":
              "https://plus.unsplash.com/premium_photo-1678718713393-2b88cde9605b?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA==",
        },
        {
          "name": "Muktinath Tour",
          "image":
              "https://lh3.googleusercontent.com/p/AF1QipPpgD0vf9gN8TCNy3q8gETTWfoarNkAynIqZVLB=s680-w680-h510-rw",
        },
        {
          "name": "Gift Voucher",
          "image":
              "https://img.freepik.com/free-vector/realistic-gift-voucher-banners_23-2149116210.jpg?semt=ais_hybrid&w=740",
        },
      ],
    },
    {
      "points": 3000,
      "rewards": [
        {
          "name": "Single Door Fridge",
          "image":
              "https://img.freepik.com/free-vector/refrigerator-with-closed-opened-door_1308-95206.jpg?ga=GA1.1.1314206690.1746510843&semt=ais_hybrid&w=740",
        },
        {
          "name": "Air Cooler",
          "image":
              "https://img.freepik.com/free-photo/air-conditioner-mounted-white-wall_53876-128235.jpg?semt=ais_hybrid&w=740",
        },
        {
          "name": "CCTV with DVR",
          "image":
              "https://www.shutterstock.com/image-vector/dvr-nvr-cloud-storage-ip-600nw-2138997913.jpg",
        },
        {
          "name": "Gift Voucher",
          "image":
              "https://img.freepik.com/free-vector/realistic-gift-voucher-banners_23-2149116210.jpg?semt=ais_hybrid&w=740",
        },
      ],
    },
  ];

  @override
  void initState() {
    super.initState();
    loadRewards();
  }

  void loadRewards() {
    final match = allRewardsData.firstWhere(
      (item) => item["points"] == definedPoints,
      orElse: () => {},
    );

    setState(() {
      matchedRewards =
          match.isNotEmpty
              ? List<Map<String, dynamic>>.from(match["rewards"])
              : [];
    });
  }

  void onRedeem(String reward) {
    showDialog(
      context: context,
      builder:
          (_) => AlertDialog(
            shape: RoundedRectangleBorder(
              borderRadius: BorderRadius.circular(16),
            ),
            title: const Text("🎉 Redeemed"),
            content: Text(
              "You have collected:\n\n🎁 $reward\n\nFrom XY Pvt Ltd",
            ),
            actions: [
              TextButton(
                onPressed: () => Navigator.pop(context),
                child: const Text(
                  "OK",
                  style: TextStyle(fontWeight: FontWeight.bold),
                ),
              ),
            ],
          ),
    );
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: const Text('Redeem Rewards'), centerTitle: true),
      body: Padding(
        padding: const EdgeInsets.all(20),
        child:
            matchedRewards.isEmpty
                ? const Center(
                  child: Text(
                    "No rewards available for 3000 points.",
                    style: TextStyle(fontSize: 16),
                  ),
                )
                : Column(
                  crossAxisAlignment: CrossAxisAlignment.start,
                  children: [
                    Text(
                      "Your Points: $definedPoints",
                      style: const TextStyle(
                        fontSize: 24,
                        fontWeight: FontWeight.bold,
                      ),
                    ),
                    const SizedBox(height: 20),
                    Expanded(
                      child: Container(
                        decoration: BoxDecoration(
                          color: Colors.white,
                          borderRadius: BorderRadius.circular(16),
                          border: Border.all(
                            color: Colors.deepPurpleAccent.withOpacity(0.2),
                            width: 1.5,
                          ),
                          boxShadow: [
                            BoxShadow(
                              color: Colors.deepPurple.withOpacity(0.05),
                              blurRadius: 8,
                              offset: const Offset(0, 4),
                            ),
                          ],
                        ),
                        padding: const EdgeInsets.all(16),
                        child: Column(
                          crossAxisAlignment: CrossAxisAlignment.start,
                          children: [
                            const Text(
                              "Available Rewards",
                              style: TextStyle(
                                fontSize: 20,
                                fontWeight: FontWeight.bold,
                              ),
                            ),
                            const SizedBox(height: 12),
                            Expanded(
                              child: ListView.builder(
                                itemCount: matchedRewards.length,
                                itemBuilder: (context, index) {
                                  final reward = matchedRewards[index];
                                  return Padding(
                                    padding: const EdgeInsets.only(
                                      bottom: 12.0,
                                    ),
                                    child: Container(
                                      decoration: BoxDecoration(
                                        color: Colors.grey[50],
                                        borderRadius: BorderRadius.circular(12),
                                        border: Border.all(
                                          color: Colors.grey.shade300,
                                        ),
                                      ),
                                      padding: const EdgeInsets.all(12),
                                      child: Row(
                                        children: [
                                          ClipRRect(
                                            borderRadius: BorderRadius.circular(
                                              12,
                                            ),
                                            child: Image.network(
                                              reward["image"],
                                              width: 100,
                                              height: 100,
                                              fit: BoxFit.cover,
                                              errorBuilder:
                                                  (
                                                    context,
                                                    error,
                                                    stackTrace,
                                                  ) => const Icon(
                                                    Icons.broken_image,
                                                    size: 100,
                                                  ),
                                            ),
                                          ),
                                          const SizedBox(width: 16),
                                          Expanded(
                                            child: Column(
                                              crossAxisAlignment:
                                                  CrossAxisAlignment.start,
                                              children: [
                                                Text(
                                                  reward["name"],
                                                  style: const TextStyle(
                                                    fontSize: 16,
                                                    fontWeight: FontWeight.bold,
                                                  ),
                                                ),
                                                const SizedBox(height: 8),
                                                ElevatedButton.icon(
                                                  style: ElevatedButton.styleFrom(
                                                    backgroundColor:
                                                        Colors.deepPurple,
                                                    foregroundColor:
                                                        Colors.white,
                                                    shape: RoundedRectangleBorder(
                                                      borderRadius:
                                                          BorderRadius.circular(
                                                            12,
                                                          ),
                                                    ),
                                                  ),
                                                  icon: const Icon(
                                                    Icons.check_circle_outline,
                                                  ),
                                                  label: const Text("Redeem"),
                                                  onPressed:
                                                      () => onRedeem(
                                                        reward["name"],
                                                      ),
                                                ),
                                              ],
                                            ),
                                          ),
                                        ],
                                      ),
                                    ),
                                  );
                                },
                              ),
                            ),
                          ],
                        ),
                      ),
                    ),
                  ],
                ),
      ),
    );
  }
}










// import 'package:flutter/material.dart';
// import 'package:redeem/data.dart';

// class RedeemScreen2 extends StatefulWidget {
//   final int definedPoints;

//   const RedeemScreen2({super.key, required this.definedPoints});

//   @override
//   State<RedeemScreen2> createState() => _RedeemScreenState();
// }

// class _RedeemScreenState extends State<RedeemScreen2> {
//   List<dynamic> matchedRewards = [];

//   @override
//   void initState() {
//     super.initState();
//     loadRewards();
//   }

//   void loadRewards() {
//     final match = allRewardsData.firstWhere(
//       (item) => item["points"] == widget.definedPoints,
//       orElse: () => {},
//     );

//     setState(() {
//       matchedRewards = match.isNotEmpty
//           ? List<Map<String, dynamic>>.from(match["rewards"])
//           : [];
//     });
//   }

//   void showRewardDetails(BuildContext context, Map reward) {
//     showModalBottomSheet(
//       context: context,
//       shape: RoundedRectangleBorder(
//         borderRadius: BorderRadius.vertical(top: Radius.circular(20)),
//       ),
//       backgroundColor: Colors.white,
//       builder: (_) {
//         return Padding(
//           padding: const EdgeInsets.all(16),
//           child: SingleChildScrollView(
//             child: Column(
//               mainAxisSize: MainAxisSize.min,
//               children: [
//                 ClipRRect(
//                   borderRadius: BorderRadius.circular(16),
//                   child: Image.network(
//                     reward["image"],
//                     width: double.infinity,
//                     height: 180,
//                     fit: BoxFit.cover,
//                     errorBuilder: (context, error, stackTrace) => Icon(
//                       Icons.broken_image,
//                       size: 100,
//                     ),
//                   ),
//                 ),
//                 SizedBox(height: 16),
//                 Text(
//                   reward["name"],
//                   style: TextStyle(
//                     fontSize: 22,
//                     fontWeight: FontWeight.bold,
//                     color: Colors.deepPurple,
//                   ),
//                 ),
//                 SizedBox(height: 10),
//                 Text(
//                   reward["description"] ?? "No description available.",
//                   textAlign: TextAlign.center,
//                   style: TextStyle(fontSize: 16, color: Colors.black87),
//                 ),
//                 SizedBox(height: 12),
//                 Text(
//                   "Points: ${widget.definedPoints}",
//                   style: TextStyle(
//                     fontWeight: FontWeight.w500,
//                     fontSize: 16,
//                     color: Colors.green,
//                   ),
//                 ),
//               ],
//             ),
//           ),
//         );
//       },
//     );
//   }

//   @override
//   Widget build(BuildContext context) {
//     return SafeArea(
//       child: Scaffold(
//         appBar: AppBar(
//           title: Text(
//             "Redeem Rewards",
//             style: TextStyle(fontWeight: FontWeight.bold),
//           ),
//           centerTitle: true,
//           backgroundColor: const Color.fromARGB(255, 89, 159, 224),
//         ),
//         body: Column(
//           children: [
//             SizedBox(height: 20),
//             Text(
//               "Your Points: ${widget.definedPoints}",
//               style: const TextStyle(fontSize: 22, fontWeight: FontWeight.bold),
//             ),
//             SizedBox(height: 20),
//             Expanded(
//               child: Padding(
//                 padding: const EdgeInsets.symmetric(horizontal: 20),
//                 child: matchedRewards.isNotEmpty
//                     ? ListView.builder(
//                         itemCount: matchedRewards.length,
//                         itemBuilder: (context, index) {
//                           final reward = matchedRewards[index];
//                           return Padding(
//                             padding: const EdgeInsets.symmetric(vertical: 8),
//                             child: Container(
//                               decoration: BoxDecoration(
//                                 boxShadow: [
//                                   BoxShadow(
//                                     color: Colors.black.withOpacity(0.1),
//                                     blurRadius: 10,
//                                     offset: Offset(0, 5),
//                                   ),
//                                 ],
//                                 color: Colors.grey[100],
//                                 borderRadius: BorderRadius.circular(12),
//                                 border: Border.all(
//                                   color: Colors.deepPurple.withOpacity(0.3),
//                                   width: 0.8,
//                                 ),
//                               ),
//                               padding: EdgeInsets.all(10),
//                               child: Row(
//                                 children: [
//                                   ClipRRect(
//                                     borderRadius: BorderRadius.circular(12),
//                                     child: Image.network(
//                                       reward["image"],
//                                       width: 120,
//                                       height: 100,
//                                       fit: BoxFit.cover,
//                                       errorBuilder: (context, error, stackTrace) =>
//                                           Icon(Icons.broken_image, size: 80),
//                                     ),
//                                   ),
//                                   SizedBox(width: 10),
//                                   Expanded(
//                                     child: Column(
//                                       crossAxisAlignment:
//                                           CrossAxisAlignment.start,
//                                       children: [
//                                         Text(
//                                           reward["name"],
//                                           style: TextStyle(
//                                             fontSize: 18,
//                                             fontWeight: FontWeight.bold,
//                                           ),
//                                         ),
//                                         SizedBox(height: 8),
//                                         Row(
//                                           children: [
//                                             ElevatedButton(
//                                               style: ElevatedButton.styleFrom(
//                                                 backgroundColor:
//                                                     Color.fromARGB(255, 89, 159, 224),
//                                               ),
//                                               onPressed: () {
//                                                 // handle redeem logic
//                                               },
//                                               child: Text(
//                                                 'Redeem',
//                                                 style: TextStyle(
//                                                   fontWeight: FontWeight.bold,
//                                                   color: Colors.black,
//                                                 ),
//                                               ),
//                                             ),
//                                             SizedBox(width: 8),
//                                             OutlinedButton(
//                                               onPressed: () =>
//                                                   showRewardDetails(context, reward),
//                                               child: Text(
//                                                 'More',
//                                                 style: TextStyle(
//                                                   color: Colors.deepPurple,
//                                                 ),
//                                               ),
//                                             ),
//                                           ],
//                                         )
//                                       ],
//                                     ),
//                                   ),
//                                 ],
//                               ),
//                             ),
//                           );
//                         },
//                       )
//                     : Center(
//                         child: Text(
//                           "No rewards available for these points.",
//                           style: TextStyle(fontSize: 16),
//                         ),
//                       ),
//               ),
//             ),
//           ],
//         ),
//       ),
//     );
//   }
// }






// splash Screen


import 'package:flutter/material.dart';
import 'package:redeem/feature/Login/screen/login_screen.dart';

class SplashScreen extends StatefulWidget {
  const SplashScreen({super.key});

  @override
  State<SplashScreen> createState() => _SplashScreenState();
}

class _SplashScreenState extends State<SplashScreen>
    with SingleTickerProviderStateMixin {
  double _scale = 0.0;
  double _opacity = 0.0;

  @override
  void initState() {
    super.initState();

    Future.delayed(Duration(milliseconds: 90), () {
      setState(() {
        _scale = 1.0;
        _opacity = 1.0;
      });
    });

    Future.delayed(const Duration(seconds: 3), () async {
      if (mounted) {
        Navigator.pushReplacement(
          context,
          MaterialPageRoute(builder: (context) => LoginScreen()),
        );
      }
    });
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      backgroundColor: Colors.white,
      body: Center(
        child: AnimatedOpacity(
          duration: const Duration(milliseconds: 1200),
          opacity: _opacity,
          child: AnimatedScale(
            scale: _scale,
            duration: const Duration(milliseconds: 1200),
            curve: Curves.easeOutBack,
            child: Image.asset(
              'assets/images/logo.png',
              width: 400,
              height: 400,
            ),
          ),
        ),
      ),
    );
  }
}











import 'dart:convert';

import 'package:flutter/material.dart';
import 'package:flutter_secure_storage/flutter_secure_storage.dart';
import 'package:http/http.dart' as http;

class RedeemList extends StatefulWidget {
  const RedeemList({super.key});

  @override
  State<RedeemList> createState() => _RedeemListState();
}

class _RedeemListState extends State<RedeemList> {
  final _storage = const FlutterSecureStorage();
  List<dynamic> redeemData = [];
  bool isLoading = true;

  @override
  void initState() {
    super.initState();
    fetchRedeemData();
  }

  Future<void> fetchRedeemData() async {
    final token = await _storage.read(key: '_token');

    if (token == null) {
      print("Token not found");
      return;
    }

    try {
      final response = await http.get(
        Uri.parse('http://192.168.1.102:8000/api/redeem/item/all'),
        headers: {
          'Authorization': 'Bearer $token',
          'Accept': 'application/json',
        },
      );

      if (response.statusCode == 200) {
        final data = json.decode(response.body);
        print("Redeem Data:");
        print(data);
        setState(() {
          redeemData = data;
          isLoading = false;
        });
      } else {
        print("Failed to load data: ${response.statusCode}");
      }
    } catch (e) {
      print("Error fetching data: $e");
    }
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: const Text("Redeem List")),
      body:
          isLoading
              ? const Center(child: CircularProgressIndicator())
              : ListView.builder(
                itemCount: redeemData.length,
                itemBuilder: (context, index) {
                  final item = redeemData[index];
                  return ListTile(
                    title: Text("Points: ${item['points']}"),
                    subtitle: Text("Scheme: ${item['scheme']['name']}"),
                  );
                },
              ),
    );
  }
}




















import 'dart:convert';

import 'package:flutter/material.dart';
import 'package:flutter_secure_storage/flutter_secure_storage.dart';
import 'package:http/http.dart' as http;

class BannerScreen extends StatefulWidget {
  const BannerScreen({super.key});

  @override
  State<BannerScreen> createState() => _BannerScreenState();
}

class _BannerScreenState extends State<BannerScreen> {
  final _storage = FlutterSecureStorage();
  List<dynamic> bannerdata = [];
  bool isLoading = true;

  @override
  void initState() {
    super.initState();
    fetchBannerData();
  }

  Future<void> fetchBannerData() async {
    final token = await _storage.read(key: '_token');

    if (token == null) {
      debugPrint('Token is empty');
      return;
    }

    try {
      final response = await http.get(
        Uri.parse('http://192.168.1.102:8000/api/banner/all'),
        headers: {'Authorization': "Bearer $token"},
      );

      if (response.statusCode == 200) {
        final data = jsonDecode(response.body);
        setState(() {
          bannerdata = data['banners'];
          isLoading = false;
        });
      } else {
        debugPrint('Failed to load banners: ${response.statusCode}');
        setState(() => isLoading = false);
      }
    } catch (e) {
      print('Error: $e');
      setState(() => isLoading = false);
    }
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      body: Center(
        child:
            isLoading
                ? CircularProgressIndicator()
                : bannerdata.isEmpty
                ? Text("No banners available")
                : Text(bannerdata[0]['description'] ?? 'No description'),
      ),
    );
  }
}




import 'dart:convert';

import 'package:flutter/material.dart';
import 'package:flutter_secure_storage/flutter_secure_storage.dart';
import 'package:http/http.dart' as http;
import 'package:redeem/feature/Login/login_screen/login_screen.dart';
import 'package:redeem/feature/Login/service/auth_service.dart';

class BannerScreen extends StatefulWidget {
  const BannerScreen({super.key});

  @override
  State<BannerScreen> createState() => _BannerScreenState();
}

class _BannerScreenState extends State<BannerScreen> {
  final AuthService _authService = AuthService();
  List<dynamic> bannerdata = [];
  bool isLoading = false;
  final _storage = FlutterSecureStorage();
  @override
  void initState() {
    // TODO: implement initState
    super.initState();
    // isLoading = true;
    fetchBannerData();
  }

  Future<void> fetchBannerData() async {
    final token = await _storage.read(key: '_token');
    if (token != null) {
      print('Token: $token');
    }

    try {
      final response = await http.get(
        Uri.parse('http://192.168.1.102:8000/api/banner/all'),
        headers: {"Authorization": "Bearer $token"},
      );
      if (response.statusCode == 200) {
        final data = jsonDecode(response.body);
        setState(() {
          bannerdata = data['banners'];
          print(bannerdata);
          isLoading = false;
        });
      }
    } catch (e) {
      print(e);
      setState(() => isLoading = false);
    }
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      body: Center(
        child: Column(
          mainAxisAlignment: MainAxisAlignment.center,
          children: [
            isLoading
                ? CircularProgressIndicator()
                : bannerdata.isEmpty
                ? Text('no data avaiable')
                : Text(bannerdata[0]['description']),

            ElevatedButton(
              onPressed: () {
                _authService.logout();
                Navigator.push(
                  context,
                  MaterialPageRoute(builder: (context) => LoginScreen()),
                );
              },
              child: Text('logout'),
            ),
          ],
        ),
      ),
    );
  }
}
